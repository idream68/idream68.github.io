---
title: elasticsearch基础
date: 2022-05-11 15:07:19
categories:
  - elasticsearch
tags:
  - elasticsearch
---

## 概述

Elasticsearch是Elastic Stack核心的分布式搜索和分析引擎。Logstash和Beats收集、聚合和丰富数据并将其存储在Elasticsearch中。Kibana提供可视化、交互式界面，并管理和监控堆栈。Elasticsearch是索引、搜索和分析的地方。

Elasticsearch为所有类型的数据提供近乎实时的搜索和分析。无论结构化数据、非结构化文本、数字数据还是地理空间数据，Elasticsearch都能用快速搜索的方式高效地存储和索引它。也可以超越简单的数据检索和聚合信息来发现数据中的趋势和模式。

Elasticsearch 可用于但不仅限于下方面：

- 向应用或网站添加搜索框
- 存储和分析日志、指标和安全事件数据
- 使用机器学习实时自动建模数据行为
- 存储自动化业务工作流程
- 地理信息系统 (GIS) 管理、集成和分析空间信息
- 生物信息学研究工具来存储和处理遗传数据
- 等等

## 文件和索引

Elasticsearch 是一个分布式文档存储。存储已序列化为 JSON 文档的复杂数据结构。当集群中有多个 节点时，存储的文档会分布在整个集群中，并且可以从任何节点立即访问。

文档被存储后，它会在近乎实时的时间内被索引并完全可搜索。Elasticsearch 使用一种称为倒排索引的数据结构，它支持非常快速的全文搜索。倒排索引列出了出现在任何文档中的每个唯一单词，并标识了每个单词出现的所有文档。

**索引**可以被认为是文档的优化集合，每个**文档**都是**字段**的**集合**，**字段**是包含数据的键值对。默认情况下，Elasticsearch 索引每个字段中的所有数据，并且每个索引字段都有一个专用的优化数据结构。例如，文本字段存储在倒排索引中，而数字和地理字段存储在 BKD 树中。使用每个字段的数据结构来组装和返回搜索结果的能力是 Elasticsearch 如此快速的原因。

Elasticsearch 还具有无模式的能力(新字段根据值类型反推字段类型)，这意味着无需明确指定如何处理文档中可能出现的每个不同字段即可对文档进行索引。启用动态映射后，Elasticsearch 会自动检测新字段并将其添加到索引中。这种默认行为使索引和探索数据变得容易——只需开始索引文档，Elasticsearch 就会检测并将布尔值、浮点和整数值、日期和字符串映射到适当的 Elasticsearch 数据类型。

也可以定义规则来控制动态映射并显式定义映射以完全控制字段的存储和索引方式。

定义自己的映射使您能够：

- 区分全文字符串字段和精确值字符串字段
- 执行特定语言的文本分析
- 优化字段以进行部分匹配
- 使用自定义日期格式
- 使用无法自动检测到 geo_point的数据类型geo_shape
- 为不同目的以不同方式索引同一字段通常很有用。例如，您可能希望将字符串字段索引为用于全文搜索- 的文本字段和用于排序或聚合数据的关键字字段。或者，您可以选择使用多个语言分析器来处理包含用户输入的字符串字段的内容。

## 搜索和分析

Elasticsearch 真正的强大之处在于能够轻松访问基于 Apache Lucene 搜索引擎库构建的全套搜索功能。提供了一个简单、连贯的 REST API，用于管理您的集群以及索引和搜索您的数据。可以直接从命令行或通过 Kibana 中的开发者控制台轻松提交请求。在应用程序中，可以根据所使用的语言选择相应的客户端，例如：Java、JavaScript、Go、.NET、PHP、Perl、Python 或 Ruby。

### 搜索数据

Elasticsearch REST API 支持结构化查询、全文查询和将两者结合的复杂查询。结构化查询类似于 SQL。除了搜索单个词语之外，您还可以执行短语搜索、相似性搜索和前缀搜索，也支持高性能地理和数字查询的优化数据结构中索引非文本数据。
可以使用 Elasticsearch 全面的 JSON 样式查询语言 ( Query DSL ) 访问所有这些搜索功能。

### 分析数据

Elasticsearch 聚合能够构建复杂的数据摘要，并深入了解关键指标、模式和趋势。聚合不仅可以找到众所周知的“大海捞针”，还可以获得下列统计数据：

- 数据总量有多少？
- 平均长度是多少？
- 中位长度是多少，按制造商细分？
- 在过去的六个月中，添加多少数据？
- 。。。

因为聚合利用了用于搜索的相同数据结构，所以它们也非常快。能够实时分析和可视化数据。报告和仪表板会随着数据的变化而更新。更重要的是，聚合与搜索请求一起运行。可以在单个请求中同时对相同数据进行搜索、过滤结果和执行分析。

[官网](https://www.elastic.co/cn/elasticsearch/)
[官方文档](https://www.elastic.co/guide/index.html)
[java客户端官方文档](https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html)
