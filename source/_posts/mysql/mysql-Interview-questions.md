---
title: mysql面试题目
date: 2021-04-28 15:19:09
categories: 
  - mysql
tags: 
  - mysql
  - 面试题
---

# 多表查询
1. ### 多表查询连接方式有哪些？

   ​		内连接、左外连接、右外连接、外连接
2. ### 解释 MySQL 外连接、内连接、左外，右外连接区别
   ​		内连接 则是只有条件的交叉连接，根据某个条件筛选出符合条件的记录，不符合条件的记录不会出现在结果集中，即内连接只连接匹配的行。
   ​		外连接 其结果集中不仅包含符合连接条件的行，而且还会包括左表、右表或两个表中的所有数据行，这三种情况依次称之为左外连接，右外连接，和全外连接。
   ​		左外连接，也称左连接，左表为主表，左表中的所有记录都会出现在结果集中，对于那些在右表中并没有匹配的记录，仍然要显示，右边对应的那些字段值以NULL 来填充。右外连接，也称右连接，右表为主表，右表中的所有记录都会出现在结果集中。左连接和右连接可以互换，MySQL 目前还不支持全外连接。



# 函数

1. ### 通用SQL函数有哪些？
   1. CONCAT(A, B) – 连接两个字符串值以创建单个字符串输出。通常用于将两个或多个字段合并为一个字段。
   2. FORMAT(X, D)- 格式化数字 X 到 D 有效数字。
   3. CURRDATE(), CURRTIME()- 返回当前日期或时间。
   4. NOW（） – 将当前日期和时间作为一个值返回。
   5. MONTH（），DAY（），YEAR（），WEEK（），WEEKDAY（） – 从日期值中提取给定数据。
   6. HOUR（），MINUTE（），SECOND（） – 从时间值中提取给定数据。
   7. DATEDIFF（A，B） – 确定两个日期之间的差异，通常用于计算年龄
   8. SUBTIMES（A，B） – 确定两次之间的差异。
   9. FROMDAYS（INT） – 将整数天数转换为日期值。



# 事务

1. ### 数据库中的事务是什么?
   ​		事务（transaction）是作为一个单元的一组有序的数据库操作。如果组中的所有操作都成功，则认为事务成功，即使只有一个操作失败，事务也不成功。如果所有操作完成，事务则提交，其修改将作用于所有其他数据库进程。如果一个操作失败，则事务将回滚，该事务所有操作的影响都将取消。
   
   ​		或者这样理解：事务就是被绑定在一起作为一个逻辑工作单元的 SQL 语句分组，如果任何一个语句操作失败那么整个操作就被失败，以后操作就会回滚到操作前状态，或者是上有个节点。为了确保要么执行，要么不执行，就可以使用事务。要将有组语句作为事务考虑，就需要通过 ACID 测试，即原子性，一致性，隔离性和持久性。
   
   事务特性：
   
   1. 原子性：即不可分割性，事务要么全部被执行，要么就全部不被执行。
   2. 一致性或可串性。事务的执行使得数据库从一种正确状态转换成另一种正确状态。
   3. 隔离性。在事务正确提交之前，不允许把该事务对数据的任何改变提供给任何其他事务。
   4. 持久性。事务正确提交后，其结果将永久保存在数据库中，即使在事务提交后有了其他故障，事务的处理结果也会得到保存。



# 索引

1. ### 简述在 MySQL 数据库中 MyISAM 和 InnoDB 索引方式的区别
   1. #### MyISAM
      1. 不支持事务，但是每次查询都是原子的；
      2. 支持表级锁，即每次操作是对整个表加锁；
      3. 存储表的总行数；
      4. 一个 MYISAM 表有三个文件：索引文件、表结构文件、数据文件；
      5. 采用菲聚集索引，索引文件的数据域存储指向数据文件的指针。辅索引与主索引基本一致，但是辅索引不用保证唯一性。
   2. #### InnoDb：
      1. 支持 ACID 的事务，支持事务的四种隔离级别；
      2. 支持行级锁及外键约束：因此可以支持写并发；
      3. 不存储总行数：
      4. 一个 InnoDb 引擎存储在一个文件空间（共享表空间，表大小不受操作系统控制，一个表可能分布在多个文件里），也有可能为多个（设置为独立表空，表大小受操作系统文件大小限制，一般为 2G），受操作系统文件大小的限制；
      5. 主键索引采用聚集索引（索引的数据域存储数据文件本身），辅索引的数据域存储主键的值；因此从辅索引查找数据，需要先通过辅索引找到主键值，再访问辅索引；最好使用自增主键，防止插入数据时，为维持 B+树结构，文件的大调整。

2. ### 索引种类
   1. 普通索引：仅加速查询
   2. 唯一索引：加速查询 + 列值唯一（可以有null）
   3. 主键索引：加速查询 + 列值唯一（不可以有null）+ 表中只有一个组合索引：多列值组成一个索引，专门用于组合搜索，其效率大于索引合并
   4. 全文索引：对文本的内容进行分词，进行搜索
3. ### 主键、外键和索引的区别？
   1. **定义：**
      主键——唯一标识一条记录，不能有重复的，不允许为空
      外键——表的外键是另一表的主键, 外键可以有重复的, 可以是空值
      索引——该字段没有重复值，但可以有一个空值
   2. **作用：**
      主键——用来保证数据完整性
      外键——用来和其他表建立联系用的
      索引——是提高查询排序的速度
   3. **个数：**
      主键—— 主键只能有一个
      外键—— 一个表可以有多个外键
      索引—— 一个表可以有多个唯一索引
4. ### 用什么语句可以看到为表格定义的所有索引？
   1. SHOW INDEX FROM <tablename>;
5. ### 对于关系型数据库而言，索引是相当重要的概念，请回答有关索引的几个问题：
   1. #### 索引的目的是什么？
      快速访问数据表中的特定信息，提高检索速度
      创建唯一性索引，保证数据库表中每一行数据的唯一性。
      加速表和表之间的连接
      使用分组和排序子句进行数据检索时，可以显著减少查询中分组和排序的时间
   2. #### 索引对数据库系统的负面影响是什么？
      负面影响：创建索引和维护索引需要耗费时间，这个时间随着数据量的增加而增加；索引需要占用物理空间，不光是表需要占用数据空间，每个索引也需要占用物理空间；当对表进行增、删、改、的时候索引也要动态维护，这样就降低了数据的维护速度。
   3. #### 为数据表建立索引的原则有哪些?
      在最频繁使用的、用以缩小查询范围的字段上建立索引。
      在频繁使用的、需要排序的字段上建立索引
   4. #### 什么情况下不宜建立索引？
      对于查询中很少涉及的列或者重复值比较多的列，不宜建立索引。
      对于一些特殊的数据类型，不宜建立索引，比如文本字段（text）等
6. ### 简单描述 MySQL 中，索引，主键，唯一索引，联合索引的区别，对数据库的性能有什么影响（从读写两方面）
   1. 索引是一种特殊的文件(InnoDB 数据表上的索引是表空间的一个组成部分)，它们包含着对数据表里所有记录的引用指针。
   2. 普通索引(由关键字 KEY 或 INDEX 定义的索引)的唯一任务是加快对数据的访问速度。
   3. 普通索引允许被索引的数据列包含重复的值。如果能确定某个数据列将只包含彼此各不相同的值，在为这个数据列创建索引的时候就应该用关键字 UNIQUE 把它定义为一个唯一索引。也就是说，唯一索引可以保证数据记录的唯一性。
   4. 主键，是一种特殊的唯一索引，在一张表中只能定义一个主键索引，主键用于唯一标识一条记录，使用关键字 PRIMARY KEY 来创建。
   5. 索引可以覆盖多个数据列，如像 INDEX(columnA, columnB)索引，这就是联合索引。
   6. 索引可以极大的提高数据的查询速度，但是会降低插入、删除、更新表的速度，因为在执行这些写操作时，还要操作索引文件。
7. ### 索引的底层实现原理和优化
   1. B+树，经过优化的 B+树
   2. 主要是在所有的叶子结点中增加了指向下一个叶子节点的指针，因此 InnoDB 建议为大部分表使用默认自增的主键作为主索引。
8. ### 什么情况下设置了索引但无法使用
   1. 以“%”开头的 LIKE 语句，模糊匹配
   2. OR 语句前后没有同时使用索引
   3. 数据类型出现隐式转化（如 varchar 不加单引号的话可能会自动转换为 int 型）
9. ### LIKE 声明中的％和_是什么意思？
   1. ％对应于 0 个或更多字符，_只是 LIKE 语句中的一个字符。



# 锁

1. ### 什么是锁？
   数据库是一个多用户使用的共享资源。当多个用户并发地存取数据时，在数据库中就会产生多个事务同时存取同一数据的情况。若对并发操作不加控制就可能会读取和存储不正确的数据，破坏数据库的一致性。
   加锁是实现数据库并发控制的一个非常重要的技术。当事务在对某个数据对象进行操作前，先向系统发出请求，对其加锁。加锁后事务就对该数据对象有了一定的控制，在该事务释放锁之前，其他的事务不能对此数据对象进行更新操作。
2. ### MySQL 中有哪几种锁？
   1. 表级锁：开销小，加锁快；不会出现死锁；锁定粒度大，发生锁冲突的概率最 高，并发度最低。
   2. 行级锁：开销大，加锁慢；会出现死锁；锁定粒度最小，发生锁冲突的概率最 低，并发度也最高。
   3. 页面锁：开销和加锁时间界于表锁和行锁之间；会出现死锁；锁定粒度界于表 锁和行锁之间，并发度一般。



# 优化

1. ### 说说对 SQL 语句优化有哪些方法？
   1.  Where 子句中：where 表之间的连接必须写在其他 Where 条件之前，那些可以过滤掉最大数量记录的条件必须写在 Where 子句的末尾.HAVING 最后。
   2.  用 EXISTS 替代 IN、用 NOT EXISTS 替代 NOT IN。
   3.  避免在索引列上使用计算
   4.  避免在索引列上使用 IS NULL 和 IS NOT NULL
   5.  对查询进行优化，应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引。
   6.  应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描
   7.  应尽量避免在 where 子句中对字段进行表达式操作，这将导致引擎放弃使用索引而进行全表扫描
2. ### 优化数据库的方法
   1. 选取最适用的字段属性，尽可能减少定义字段宽度，尽量把字段设置 NOTNULL，例如’省份’、’性别’最好适用 ENUM
   2. 使用连接(JOIN)来代替子查询
   3. 适用联合(UNION)来代替手动创建的临时表
   4. 事务处理
   5. 锁定表、优化事务处理
   6. 适用外键，优化锁定表
   7. 建立索引
   8. 优化查询语句



# 视图

1. ### 试述视图的优点？
   1. 视图能够简化用户的操作
   2. 视图使用户能以多种角度看待同一数据；
   3. 视图为数据库提供了一定程度的逻辑独立性；
   4. 视图能够对机密数据提供安全保护。



# 设计

1. ### 如何通俗地理解三个范式？
   1. 第一范式：1NF 是对属性的原子性约束，要求属性具有原子性，不可再分解；
   2. 第二范式：2NF 是对记录的惟一性约束，要求记录有惟一标识，即实体的惟一性；
   3. 第三范式：3NF 是对字段冗余性的约束，即任何字段不能由其他字段派生出来，它要求字段没有冗余。。
2. ### 范式化设计优缺点:
   1. 优点:可以尽量得减少数据冗余，使得更新快，体积小
   2. 缺点:对于查询需要多个表进行关联，减少写得效率增加读得效率，更难进行索引优化
3. #### 反范式化:
   1. 优点:可以减少表得关联，可以更好得进行索引优化
   2. 缺点:数据冗余以及数据异常，数据得修改需要更多的成本



# 编程方面

1. ### SQL 注入漏洞产生的原因？如何防止？
   SQL 注入产生的原因：程序开发过程中不注意规范书写 sql 语句和对特殊字符进行过滤，导致客户端可以通过全局变量 POST 和 GET 提交一些 sql 语句正常执行。
   防止 SQL 注入的方式：
   
   1. 开启配置文件中的 magic_quotes_gpc 和 magic_quotes_runtime 设置
   2. 执行 sql 语句时使用 addslashes 进行 sql 语句转换
   3. Sql 语句书写尽量不要省略双引号和单引号。
   4. 过滤掉 sql 语句中的一些关键词：update、insert、delete、select、 * 。
   5. 提高数据库表和字段的命名技巧，对一些重要的字段根据程序的特点命名，取不易被猜到的。